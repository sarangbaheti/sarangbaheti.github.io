<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Multithreading in C# - part 1</title>

  <meta name="author" content="Sarang Baheti" />
  
  

  <meta name="generator" content="Hugo 0.30.2" />

  <link rel="alternate" href="https://www.variadic.xyz/index.xml" type="application/rss+xml" title="a few notes">

  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://www.variadic.xyz/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://www.variadic.xyz/css/main.css" />
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/default.min.css">
  
  
  
  <meta property="og:title" content="Multithreading in C# - part 1" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/2011/09/16/multithreading-in-c-part-1//" />
  <meta property="og:image" content="" />
  
</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://www.variadic.xyz/">a few notes</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
          <li>
          <a title="Notes" href="/">Notes</a>
  	      </li>
  	    
      
        
          <li>
          <a title="About" href="/about/">About</a>
  	      </li>
  	    
      
        
          <li>
          <a title="Archive" href="/archive/">Archive</a>
  	      </li>
  	    
      
        
          <li>
          <a title="Books" href="/books/">Books</a>
  	      </li>
  	    
      
        
          <li>
          <a title="Disclaimer" href="/disclaimer/">Disclaimer</a>
  	      </li>
  	    
      
      </ul>
    </div>

	<div class="avatar-container">
	  <div class="avatar-img-border">
      
	  </div>
	</div>

  </div>
</nav>


    <div role="main" class="container main-content">

      
        





<header class="header-section ">

<div class="intro-header no-img">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-heading">
          <h1>Multithreading in C# - part 1</h1>
      
      
      
      <span class="post-meta">Posted on September 16, 2011</span>
      
        </div>
      </div>
    </div>
  </div>
</div>
</header>




<div class="container">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
          <p><a href="http://www.nullptr.me/2011/09/16/multithreading-in-c11-part-1/">Here</a> I posted multithreading in C++11. Well I did ran into issues with C++ library. To validate I tried the same dotproduct example in C#.</p>

<p>Here is the code for the same:</p>

<pre><code class="language-csharp">using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ConsoleApplication1
{
    class DotProduct
    {
        double[] a;
        double[] b;
        double[] res;
        int id;
        int numElems;

        public DotProduct(double[] aa, double[] bb,
            double[] r, int nElems, int ident)
        {
            a = aa;
            b = bb;
            res = r;
            id = ident;
            numElems = nElems;
        }

        public void Evaluate()
        {
            res[id] = 0;
            for (int idx = id * numElems, end = (id + 1) * numElems;
                idx &amp;lt; end; ++idx)
            {
                res[id] += a[idx] * b[idx];
            }
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            int numElements = 100000;
            double[] a = new double[numElements];
            double[] b = new double[numElements];

            for (int idx = 0; idx &amp;lt; numElements; ++idx)
            {
                a[idx] = idx;
                b[idx] = numElements - idx;
            }

            double[] result = new double[4];
            int numElems = numElements / 4;

            DotProduct dp1 = new DotProduct(a, b, result, numElems, 0);
            System.Threading.Thread thread1 =
                new System.Threading.Thread(new System.Threading.ThreadStart(dp1.Evaluate));

            DotProduct dp2 = new DotProduct(a, b, result, numElems, 1);
            System.Threading.Thread thread2 =
                new System.Threading.Thread(new System.Threading.ThreadStart(dp2.Evaluate));

            DotProduct dp3 = new DotProduct(a, b, result, numElems, 2);
            System.Threading.Thread thread3 =
                new System.Threading.Thread(new System.Threading.ThreadStart(dp3.Evaluate));

            DotProduct dp4 = new DotProduct(a, b, result, numElems, 3);
            System.Threading.Thread thread4 =
                new System.Threading.Thread(new System.Threading.ThreadStart(dp4.Evaluate));

            thread1.Start();
            thread2.Start();
            thread3.Start();
            thread4.Start();

            thread1.Join();
            thread2.Join();
            thread3.Join();
            thread4.Join();

            System.Console.WriteLine(&quot;Dotproduct is {0} &quot;,
                (result[0] + result[1] + result[2] + result[3]));

            System.Console.ReadKey();

        }
    }
}
</code></pre>

<p>First we create DotProduct class that holds the arrays and result array. Every DotProduct class has an id to identify the range of array it is going to operate on. Next we create 4 threads and pass-in for instances of DotProduct and the method to be executed on the thread. Unlike C++11, creating thread does not start the thread, it has to be called explicitly. Then as discussed in C++11 multithreading post we wait until all the threads have completed the execution. That&rsquo;s it. Quite simple.
More to come. Stay tuned&hellip;</p>

      </article>

      <ul class="pager blog-pager">
        
        <li class="previous">
          <a href="https://www.variadic.xyz/2011/09/16/multithreading-in-c11-part-1/" data-toggle="tooltip" data-placement="top" title="Multithreading in C&#43;&#43;11 - part 1">&larr; Previous Post</a>
        </li>
        
        
        <li class="next">
          <a href="https://www.variadic.xyz/2011/09/18/multithreading-in-c11-part-2/" data-toggle="tooltip" data-placement="top" title="Multithreading in C&#43;&#43;11 - part 2">Next Post &rarr;</a>
        </li>
        
      </ul>

      

    </div>
  </div>
</div>

      

    </div>

    <footer>
  <div class="container beautiful-jekyll-footer">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
          
          <li>
            <a href="https://github.com/sarangbaheti" title="GitHub">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		      
		      
          <li>
            <a href="https://linkedin.com/in/sarangbaheti" title="LinkedIn">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
	    	  
          <li>
            <a href="https://stackoverflow.com/users/916549/sarang" title="StackOverflow">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
    		  <li>
      			<a href="https://www.variadic.xyz/index.xml" title="RSS">
      			  <span class="fa-stack fa-lg">
        				<i class="fa fa-circle fa-stack-2x"></i>
        				<i class="fa fa-rss fa-stack-1x fa-inverse"></i>
      			  </span>
      			</a>
    		  </li>		

        </ul>
        <p class="copyright text-muted">
    		  Sarang Baheti
    		  &nbsp;&bull;&nbsp;
    		  2009 - 2020
    		  
    		  
    		  &nbsp;&bull;&nbsp;
    		  <a href="https://www.variadic.xyz/">a few notes</a>
    		  
  	    </p>
  	        
    		<p class="theme-by text-muted">
    		  Theme by
    		  <a href="https://github.com/sarangbaheti/bh">bh</a>
    		</p>
      </div>
    </div>
  </div>
</footer>

<script src="https://www.variadic.xyz/js/jquery-1.11.2.min.js"></script>
<script src="https://www.variadic.xyz/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script>
<script src="https://www.variadic.xyz/js/main.js"></script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-27935503-1', 'auto');
ga('send', 'pageview');
</script>



  </body>
</html>
