<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>cmd line concurrency tools</title>

  <meta name="author" content="Sarang Baheti" />
  
  
  <meta name="description" content="concurrency visualizer cmd line tools">
  

  <meta name="generator" content="Hugo 0.30.2" />

  <link rel="alternate" href="https://www.variadic.xyz/index.xml" type="application/rss+xml" title="a few notes">

  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://www.variadic.xyz/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://www.variadic.xyz/css/main.css" />
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/default.min.css">
  
  
  
  <meta property="og:title" content="cmd line concurrency tools" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/2020/05/14/concurrency-visualizer//" />
  <meta property="og:image" content="" />
  
</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://www.variadic.xyz/">a few notes</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
          <li>
          <a title="Notes" href="/">Notes</a>
  	      </li>
  	    
      
        
          <li>
          <a title="About" href="/about/">About</a>
  	      </li>
  	    
      
        
          <li>
          <a title="Archive" href="/archive/">Archive</a>
  	      </li>
  	    
      
        
          <li>
          <a title="Books" href="/books/">Books</a>
  	      </li>
  	    
      
        
          <li>
          <a title="Disclaimer" href="/disclaimer/">Disclaimer</a>
  	      </li>
  	    
      
      </ul>
    </div>

	<div class="avatar-container">
	  <div class="avatar-img-border">
      
	  </div>
	</div>

  </div>
</nav>


    <div role="main" class="container main-content">

      
        





<header class="header-section ">

<div class="intro-header no-img">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-heading">
          <h1>cmd line concurrency tools</h1>
      
      
      
      <span class="post-meta">Posted on May 14, 2020</span>
      
        </div>
      </div>
    </div>
  </div>
</div>
</header>




<div class="container">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
          <p>Tracing and Analyzing application from within VS2019 using <a href="https://docs.microsoft.com/en-us/visualstudio/profiling/concurrency-visualizer?view=vs-2019">Concurrency Visualizer</a> often keeps crashing for me. Also, I have been looking into some sort of cmd line support to make it seamless with automated workflows.</p>


<figure >
    
        <img src="/images/2020-05-14-concurrency-viz1.png" />
    
    
</figure>



<figure >
    
        <img src="/images/2020-05-14-concurrency-viz2.png" />
    
    
</figure>


<p>Found that there is a <a href="https://docs.microsoft.com/en-us/visualstudio/profiling/concurrency-visualizer-command-line-utility-cvcollectioncmd?view=vs-2019">Concurrency Visualizer Cmd utility</a> and even though it is <a href="https://www.microsoft.com/en-us/download/details.aspx?id=49103">versioned as VS2015</a> it still works just fine.</p>

<p>Typically it will be installed in <code>c:\program files\Microsoft Concurrency Visualizer Collection Tools\</code> directory, so getting in path with those spaces is a pain, but that&rsquo;s what it is..</p>

<p>Launching/Attaching is quite breeze and so in analyzing the trace. Here is one such case where i have provided with <code>pid</code> instead of process-name.</p>

<pre><code>CVCollectionCmd.exe /attach /process 58284 /outdir  D:\scratch\ConcurrencyViz
CVCollectionCmd.exe /detach

set _NT_SYMBOL_PATH=D:\workdir\application\pdbs;srv*c:\Symbols*http://msdl.microsoft.com/download/symbols
CVCollectionCmd.exe /Analyze &quot;D:\scratch\ConcurrencyViz\application_2020-05-14_121119.CvTrace&quot;
</code></pre>

<p>Analysis is where it starts looking up the symbols and does a lot of heavy lifting. Note it will overwrite your traces with new symbols information. In case this messes up there is no way to get back traced data (better to have a copy if you are worried about it).</p>

<pre><code>CVCollectionCmd.exe /Analyze &quot;D:\scratch\ConcurrencyViz\application_2020-05-14_121119.CvTrace&quot;
Microsoft (R) Concurrency Visualizer Collection Tool Version 14.0.50916.4
Copyright (C) Microsoft Corp. All rights reserved.

Event Parsing... 1%
Event Parsing... 2%
...
Event Parsing... 100%
Downloading PDBs... 0%
Downloading PDBs... 100%
Resolving Symbols... 0%
Resolving Symbols... 1%
Resolving Symbols... 2%
...
Resolving Symbols... 98%
Resolving Symbols... 99%
Resolving Symbols... 100%
Analyzing... 1%
Analyzing... 2%
...
Analyzing... 100%
Analysis of trace &quot;D:\scratch\ConcurrencyViz\application_2020-05-14_121119.CvTrace&quot; completed successfully.
</code></pre>

<blockquote>
<p>ensure cmd is started with admin privileges, else the traces after analysis will be garbage</p>
</blockquote>

<p>We don&rsquo;t need to specify symbols path for tracing, in my case i ran the application and provided the <code>pid</code> for attaching. Now the funny thing is that even if the traced process exited colection won&rsquo;t stop, you have to manually <code>detach</code> to stop. The comes the bit about specifying the symbol-paths and analyzing.</p>

<p>That&rsquo;s it really, works pretty cool..</p>

      </article>

      <ul class="pager blog-pager">
        
        <li class="previous">
          <a href="https://www.variadic.xyz/2020/05/11/apple-self-congratulatory-behavior/" data-toggle="tooltip" data-placement="top" title="magic keyboard">&larr; Previous Post</a>
        </li>
        
        
      </ul>

      

    </div>
  </div>
</div>

      

    </div>

    <footer>
  <div class="container beautiful-jekyll-footer">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
          
          <li>
            <a href="https://github.com/sarangbaheti" title="GitHub">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		      
		      
          <li>
            <a href="https://linkedin.com/in/sarangbaheti" title="LinkedIn">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
	    	  
          <li>
            <a href="https://stackoverflow.com/users/916549/sarang" title="StackOverflow">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
    		  <li>
      			<a href="https://www.variadic.xyz/index.xml" title="RSS">
      			  <span class="fa-stack fa-lg">
        				<i class="fa fa-circle fa-stack-2x"></i>
        				<i class="fa fa-rss fa-stack-1x fa-inverse"></i>
      			  </span>
      			</a>
    		  </li>		

        </ul>
        <p class="copyright text-muted">
    		  Sarang Baheti
    		  &nbsp;&bull;&nbsp;
    		  2009 - 2020
    		  
    		  
    		  &nbsp;&bull;&nbsp;
    		  <a href="https://www.variadic.xyz/">a few notes</a>
    		  
  	    </p>
  	        
    		<p class="theme-by text-muted">
    		  Theme by
    		  <a href="https://github.com/sarangbaheti/bh">bh</a>
    		</p>
      </div>
    </div>
  </div>
</footer>

<script src="https://www.variadic.xyz/js/jquery-1.11.2.min.js"></script>
<script src="https://www.variadic.xyz/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script>
<script src="https://www.variadic.xyz/js/main.js"></script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-27935503-1', 'auto');
ga('send', 'pageview');
</script>



  </body>
</html>
